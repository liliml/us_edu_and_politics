<!-- This is the first page users will see when they open the the webpage, all
other links people click on that go to differnet pages or views should be a new htmls files
created in the html folder -->

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Educational Attainment in US (2010-2023)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://api.tiles.mapbox.com/mapbox-gl-js/v3.3.0/mapbox-gl.js"></script>
    <link
      href="https://api.tiles.mapbox.com/mapbox-gl-js/v3.3.0/mapbox-gl.css"
      rel="stylesheet"
    />
    <style>
      body {
        margin: 0;
        padding: 0px;
        font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
      }

      #map {
        position: absolute;
        top: 50px;
        bottom: 0;
        width: 100%;
      }

      #console {
        position: absolute;
        top: 75px;
        left: 10px;
        width: 260px;
        background-color: white;
        padding: 15px;
        box-shadow: 0px 0px 5px rgba(0, 0, 0, 0.2);
        border-radius: 5px;
      }

      h1 {
        font-size: 18px;
        margin-bottom: 10px;
      }

      h2 {
        font-size: 14px;
        margin-bottom: 5px;
      }

      a {
        text-decoration: none;
        color: #2dc4b2;
      }

      .session {
        margin-bottom: 15px;
      }

      .row {
        height: 12px;
        width: 100%;
      }

      .colors {
        background: linear-gradient(
          to right,
          #2dc4b2,
          #3bb3c3,
          #669ec4,
          #8b88b6,
          #a2719b,
          #aa5e79
        );
        margin-bottom: 5px;
      }

      .label {
        width: 20%;
        display: inline-block;
        text-align: center;
      }

      .topnav {
          background-color: rgb(128, 123, 123);
          overflow: hidden;
          display: flex;
          flex-wrap: wrap;
          align-items: center;
          position: fixed;
          z-index: 1000;
          width: 100%;
          padding: 0;
          border-radius: 10px 10px 10px 10px;
      }

      .topnav a {
          color: black;
          padding: 1%;
          display: block;
      }

      .topnav a:hover {
          background-color: rgb(196, 193, 193);
          color: black
      }

      .topnav a.active {
          background-color: rgb(36, 35, 36);
          color: rgb(219, 219, 219)
      }

      .topnav .icon {
        display: none;
        font-size: 20px;
        padding: 14px;
        cursor: pointer;
      }
    </style>
  </head>

  <body>
    <div class="topnav" id="myTopnav">
      <!-- Active link pointing to the index.html page -->
      <a class="active" href="index.html">Map</a>

      <!-- Links to other sections -->
      <a href="html\intro.html">Introduction</a>
      <a href="html\conclusion.html">Conclusion</a>

      <!-- "Hamburger menu" / "Bar icon" to toggle the navigation links on smaller screens -->
      <a href="javascript:void(0);" class="icon" onclick="responsive_control()">
          <i class="fa fa-bars"></i>
      </a>
  </div>
    <div id="map"></div>
    <div id="console">
      <h1>Educational Attainment in US</h1>
      <p>
        Data source:
        <a href="https://data.census.gov/table?q=educational%20attainment%20by%20state">
          US Census Data on Educational Attainment
        </a>
      </p>

      <div class="session">
        <h2>Year: <label id="yearLabel">2010</label></h2>
        <input
          id="yearSlider"
          type="range"
          min="2010"
          max="2023"
          step="1"
          value="2010"
          style="width: 100%"
        />
      </div>

      <div class="session">
        <h2>Bachelorâ€™s Degree Rate</h2>
        <div class="row colors"></div>
        <div class="row labels">
          <div class="label">0%</div>
          <div class="label">25%</div>
          <div class="label">50%</div>
          <div class="label">75%</div>
          <div class="label">100%</div>
        </div>
      </div>
    </div>
  </body>
</html>

    <script>
    function responsive_control() {
    // Get the element with the id "myTopnav"
      let x = document.getElementById("myTopnav");
      // Check if the class name of the element is "topnav"
      if (x.className === "topnav") {
        // If it is, add the "responsive" class to the element
        x.className += " responsive";
      } else {
        // If it's not, remove the "responsive" class from the element
        x.className = "topnav";
      }
    }
    
    mapboxgl.accessToken = 'pk.eyJ1IjoibHlubmllMDMzMCIsImEiOiJjbTdzajl2MWExYzJmMnBvYXNpYndjamlxIn0.YiU2nPVukAuXf19cZTcfSw';

    const years = [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2021, 2022, 2023];
    let currentYear = 2010;  // AI

    const map = new mapboxgl.Map({
        container: 'map',
        style: 'mapbox://styles/millzm/cm7zcffi000co01ss0ba3asfe',
        center: [-98.5795, 39.8283],
        zoom: 5
    });

        map.on('load', () => {
            years.forEach(year => {  // AI
                map.addSource(`educationData_${year}`, {
                    type: 'geojson',
                    data: `assets/2010_data.geojson`
                });

                map.addLayer({
                    id: `educationLayer_${year}`,
                    type: 'circle',
                    source: `educationData_${year}`,
                    paint: {
                        'circle-radius': [
                            'interpolate',
                            ['linear'],
                            ['number', ['get', 'bachelor_degree_rate']],
                            0, 4,
                            25, 8,
                            50, 12,
                            75, 16,
                            100, 24
                        ],
                        'circle-color': [
                            'interpolate',
                            ['linear'],
                            ['number', ['get', 'bachelor_degree_rate']],
                            0, '#2DC4B2',
                            25, '#3BB3C3',
                            50, '#669EC4',
                            75, '#8B88B6',
                            100, '#AA5E79'
                        ],
                        'circle-opacity': 0.8
                    },
                    'layout': {
                        'visibility': year === currentYear ? 'visible' : 'none'
                    }
                });
            });
        });

        // 
        document.getElementById('yearSlider').addEventListener('input', (event) => {
            const year = parseInt(event.target.value);
            document.getElementById('yearLabel').textContent = year;

            years.forEach(y => {
                map.setLayoutProperty(`educationLayer_${y}`, 'visibility', y === year ? 'visible' : 'none');
            });
        });
    </script>
